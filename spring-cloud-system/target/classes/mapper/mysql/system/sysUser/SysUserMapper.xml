<?xml version="1.0" encoding="UTF-8" ?>
<!DOCTYPE mapper PUBLIC "-//mybatis.org//DTD Mapper 3.0//EN" "http://mybatis.org/dtd/mybatis-3-mapper.dtd" >
<mapper namespace="com.example.spring.cloud.system.sysUser.mapper.SysUserMapper" >
	<!-- 查询单表的字段 -->
	<sql id="tableColumns">
	    t.id as "id",
	    t.user_name as "userName",
	    t.password as "password",
	    t.name as "name",
	    t.department_id as "departmentId",
	    t.state as "state",
	    t.email as "email",
	    t.phone as "phone",
	    t.head_icon as "headIcon",
	    d.id as "sysDepartment.id",
	    d.name as "sysDepartment.name",
	    d.code as "sysDepartment.code"
	</sql>
	<!-- 查询过滤条件 -->
	<sql id="whereStr">
		<where>
			1=1
			<if test="id != null and id != ''">
				and t.id LIKE '%${id}%'
			</if>
			<if test="userName != null and userName != ''">
				and t.user_name LIKE '%${userName}%'
			</if>
			<if test="password != null and password != ''">
				and t.password LIKE '%${password}%'
			</if>
			<if test="name != null and name != ''">
				and t.name LIKE '%${name}%'
			</if>
			<if test="departmentId != null and departmentId != ''">
				and t.department_id LIKE '%${departmentId}%'
			</if>
			<if test="state != null and state != ''">
				and t.state LIKE '%${state}%'
			</if>
			<if test="email != null and email != ''">
				and t.email LIKE '%${email}%'
			</if>
			<if test="phone != null and phone != ''">
				and t.phone LIKE '%${phone}%'
			</if>
		</where>
	</sql>
	<sql id="orderBy">
		ORDER BY t.user_name
	</sql>

	<!-- 根据账号查询单条数据 -->
	<select id="findByUserName" resultType="com.example.spring.cloud.system.sysUser.domain.SysUser">
		SELECT
		<include refid="tableColumns" />
		FROM SYS_USER t
		left join sys_department d on t.department_id=d.id
		WHERE user_name = #{userName}
	</select>

</mapper>
